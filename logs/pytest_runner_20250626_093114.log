2025-06-26 09:31:14,159 - INFO - üöÄ STARTING ENHANCED PYTEST TEST SUITE üöÄ
2025-06-26 09:31:14,159 - INFO - Working directory: /home/ubuntu/examen_bentoml
2025-06-26 09:31:14,159 - INFO - Python version: 3.10.18 (main, Jun  4 2025, 08:56:00) [GCC 9.4.0]
2025-06-26 09:31:14,159 - INFO - 
================================================================================
2025-06-26 09:31:14,160 - INFO - Running: Verify pytest installation
2025-06-26 09:31:14,160 - INFO - Command: python -c "import pytest; print(f'pytest version: {pytest.__version__}')"
2025-06-26 09:31:14,160 - INFO - ================================================================================
2025-06-26 09:31:14,410 - INFO - ‚úÖ SUCCESS: Verify pytest installation
2025-06-26 09:31:14,411 - INFO - Output:
pytest version: 8.4.1

2025-06-26 09:31:14,411 - INFO - 
================================================================================
2025-06-26 09:31:14,411 - INFO - Running: Data Preparation Tests
2025-06-26 09:31:14,411 - INFO - Command: python -m pytest tests/test_data_preparation.py -v
2025-06-26 09:31:14,412 - INFO - ================================================================================
2025-06-26 09:31:17,669 - ERROR - ‚ùå FAILED: Data Preparation Tests
2025-06-26 09:31:17,670 - ERROR - Standard output:
============================= test session starts ==============================
platform linux -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /home/ubuntu/examen_bentoml/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/ubuntu/examen_bentoml
configfile: pyproject.toml
plugins: anyio-4.9.0, cov-6.2.1
collecting ... collected 15 items

tests/test_data_preparation.py::TestDataLoading::test_load_existing_file PASSED [  6%]
tests/test_data_preparation.py::TestDataLoading::test_load_nonexistent_file PASSED [ 13%]
tests/test_data_preparation.py::TestDataLoading::test_load_invalid_file PASSED [ 20%]
tests/test_data_preparation.py::TestDataCleaning::test_remove_serial_column PASSED [ 26%]
tests/test_data_preparation.py::TestDataCleaning::test_duplicate_removal PASSED [ 33%]
tests/test_data_preparation.py::TestDataCleaning::test_missing_values_handling PASSED [ 40%]
tests/test_data_preparation.py::TestDataCleaning::test_data_types_preserved PASSED [ 46%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_feature_target_separation PASSED [ 53%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_missing_target_column PASSED [ 60%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_feature_names PASSED [ 66%]
tests/test_data_preparation.py::TestDataSplitting::test_split_proportions PASSED [ 73%]
tests/test_data_preparation.py::TestDataSplitting::test_split_reproducibility PASSED [ 80%]
tests/test_data_preparation.py::TestDataSplitting::test_no_data_leakage PASSED [ 86%]
tests/test_data_preparation.py::TestDataIntegrity::test_processed_data_exists PASSED [ 93%]
tests/test_data_preparation.py::TestDataIntegrity::test_data_consistency PASSED [100%]
ERROR: Coverage failure: total of 28 is less than fail-under=30


=============================== warnings summary ===============================
tests/test_data_preparation.py::TestDataCleaning::test_missing_values_handling
  /home/ubuntu/examen_bentoml/src/prepare_data.py:70: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
  The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
  
  For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
  
  
    df[col].fillna(df[col].median(), inplace=True)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.18-final-0 _______________

Name                  Stmts   Miss  Cover   Missing
---------------------------------------------------
src/__init__.py           6      6     0%   8-15
src/prepare_data.py     117     44    62%   43-45, 131-158, 162-201
src/train_model.py      142    142     0%   6-297
---------------------------------------------------
TOTAL                   265    192    28%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 30% not reached. Total coverage: 27.55%
======================== 15 passed, 1 warning in 2.22s =========================

2025-06-26 09:31:17,670 - INFO - 
================================================================================
2025-06-26 09:31:17,670 - INFO - Running: Model Training Tests
2025-06-26 09:31:17,670 - INFO - Command: python -m pytest tests/test_model_training.py -v
2025-06-26 09:31:17,671 - INFO - ================================================================================
2025-06-26 09:31:22,592 - ERROR - ‚ùå FAILED: Model Training Tests
2025-06-26 09:31:22,592 - ERROR - Standard output:
============================= test session starts ==============================
platform linux -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /home/ubuntu/examen_bentoml/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/ubuntu/examen_bentoml
configfile: pyproject.toml
plugins: anyio-4.9.0, cov-6.2.1
collecting ... collected 15 items

tests/test_model_training.py::TestDataLoading::test_load_processed_data_success PASSED [  6%]
tests/test_model_training.py::TestDataLoading::test_load_processed_data_missing_files PASSED [ 13%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_shapes PASSED [ 20%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_normalization PASSED [ 26%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_consistency PASSED [ 33%]
tests/test_model_training.py::TestModelCreation::test_create_models_returns_dict PASSED [ 40%]
tests/test_model_training.py::TestModelCreation::test_create_models_types PASSED [ 46%]
tests/test_model_training.py::TestModelCreation::test_models_have_random_state PASSED [ 53%]
tests/test_model_training.py::TestModelEvaluation::test_evaluate_models_cv_returns_results PASSED [ 60%]
tests/test_model_training.py::TestModelEvaluation::test_best_model_selection PASSED [ 66%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_structure PASSED [ 73%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_perfect_prediction PASSED [ 80%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_bounds PASSED [ 86%]
tests/test_model_training.py::TestModelTraining::test_train_best_model PASSED [ 93%]
tests/test_model_training.py::TestIntegrationTests::test_full_pipeline_with_real_data PASSED [100%]
ERROR: Coverage failure: total of 29 is less than fail-under=30


=============================== warnings summary ===============================
tests/test_model_training.py:259
  /home/ubuntu/examen_bentoml/tests/test_model_training.py:259: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.18-final-0 _______________

Name                  Stmts   Miss  Cover   Missing
---------------------------------------------------
src/__init__.py           6      6     0%   8-15
src/prepare_data.py     117    117     0%   6-201
src/train_model.py      142     64    55%   44, 161-187, 191-223, 227-243, 247-297
---------------------------------------------------
TOTAL                   265    187    29%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 30% not reached. Total coverage: 29.43%
======================== 15 passed, 1 warning in 3.90s =========================

2025-06-26 09:31:22,593 - INFO - 
================================================================================
2025-06-26 09:31:22,594 - INFO - Running: BentoML Integration Tests
2025-06-26 09:31:22,594 - INFO - Command: python -m pytest tests/test_bentoml_integration.py -v
2025-06-26 09:31:22,594 - INFO - ================================================================================
2025-06-26 09:31:29,720 - ERROR - ‚ùå FAILED: BentoML Integration Tests
2025-06-26 09:31:29,720 - ERROR - Error output:
/home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/coverage/control.py:915: CoverageWarning: No data was collected. (no-data-collected)
  self._warn("No data was collected.", slug="no-data-collected")

2025-06-26 09:31:29,720 - ERROR - Standard output:
============================= test session starts ==============================
platform linux -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /home/ubuntu/examen_bentoml/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/ubuntu/examen_bentoml
configfile: pyproject.toml
plugins: anyio-4.9.0, cov-6.2.1
collecting ... collected 11 items

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load PASSED [  9%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_metadata PASSED [ 18%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_custom_objects PASSED [ 27%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_prediction_service PASSED [ 36%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_store_listing PASSED [ 45%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_deletion FAILED [ 54%]
tests/test_bentoml_integration.py::TestModelPerformanceValidation::test_saved_model_performance_threshold PASSED [ 63%]
tests/test_bentoml_integration.py::TestModelPerformanceValidation::test_model_feature_consistency PASSED [ 72%]
tests/test_bentoml_integration.py::TestErrorHandling::test_load_nonexistent_model PASSED [ 81%]
tests/test_bentoml_integration.py::TestErrorHandling::test_save_invalid_model PASSED [ 90%]
tests/test_bentoml_integration.py::TestErrorHandling::test_prediction_with_wrong_input_shape PASSED [100%]
ERROR: Coverage failure: total of 0 is less than fail-under=30


=================================== FAILURES ===================================
__________________ TestBentoMLIntegration.test_model_deletion __________________

self = <test_bentoml_integration.TestBentoMLIntegration object at 0x7f9928ffa950>

    def test_model_deletion(self):
        """Test model deletion from BentoML store."""
        from sklearn.linear_model import LinearRegression
    
        # Create a temporary model
        model = LinearRegression()
        X = pd.DataFrame(SAMPLE_DATA)
        y = np.array([0.7, 0.9, 0.4])
        model.fit(X, y)
    
        saved_model = bentoml.sklearn.save_model(
            f"{BENTOML_MODEL_NAME}_deletion_test",
            model,
            metadata={"temporary": True}
        )
    
        # Verify model exists
        assert bentoml.models.get(saved_model.tag) is not None
    
        # Delete model
        bentoml.models.delete(saved_model.tag)
    
        # Verify model is deleted
        with pytest.raises(bentoml.exceptions.NotFound):
            bentoml.models.get(saved_model.tag)
        with pytest.raises(bentoml.exceptions.NotFound):
>           bentoml.models.get(model_tag)
E           NameError: name 'model_tag' is not defined

tests/test_bentoml_integration.py:189: NameError
=============================== warnings summary ===============================
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/__init__.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/__init__.py:4: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/opener/__init__.py:6: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs.opener')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/pkg_resources/__init__.py:2558: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_prediction_service
tests/test_bentoml_integration.py::TestErrorHandling::test_prediction_with_wrong_input_shape
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.18-final-0 _______________

Name                  Stmts   Miss  Cover   Missing
---------------------------------------------------
src/__init__.py           6      6     0%   8-15
src/prepare_data.py     117    117     0%   6-201
src/train_model.py      142    142     0%   6-297
---------------------------------------------------
TOTAL                   265    265     0%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 30% not reached. Total coverage: 0.00%
=========================== short test summary info ============================
FAILED tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_deletion - NameError: name 'model_tag' is not defined
=================== 1 failed, 10 passed, 6 warnings in 5.92s ===================

2025-06-26 09:31:29,722 - INFO - 
================================================================================
2025-06-26 09:31:29,722 - INFO - Running: Full Test Suite
2025-06-26 09:31:29,722 - INFO - Command: python -m pytest tests/ -v
2025-06-26 09:31:29,722 - INFO - ================================================================================
2025-06-26 09:31:39,354 - ERROR - ‚ùå FAILED: Full Test Suite
2025-06-26 09:31:39,354 - ERROR - Standard output:
============================= test session starts ==============================
platform linux -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /home/ubuntu/examen_bentoml/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/ubuntu/examen_bentoml
configfile: pyproject.toml
plugins: anyio-4.9.0, cov-6.2.1
collecting ... collected 41 items

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load PASSED [  2%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_metadata PASSED [  4%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_custom_objects PASSED [  7%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_prediction_service PASSED [  9%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_store_listing PASSED [ 12%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_deletion FAILED [ 14%]
tests/test_bentoml_integration.py::TestModelPerformanceValidation::test_saved_model_performance_threshold PASSED [ 17%]
tests/test_bentoml_integration.py::TestModelPerformanceValidation::test_model_feature_consistency PASSED [ 19%]
tests/test_bentoml_integration.py::TestErrorHandling::test_load_nonexistent_model PASSED [ 21%]
tests/test_bentoml_integration.py::TestErrorHandling::test_save_invalid_model PASSED [ 24%]
tests/test_bentoml_integration.py::TestErrorHandling::test_prediction_with_wrong_input_shape PASSED [ 26%]
tests/test_data_preparation.py::TestDataLoading::test_load_existing_file PASSED [ 29%]
tests/test_data_preparation.py::TestDataLoading::test_load_nonexistent_file PASSED [ 31%]
tests/test_data_preparation.py::TestDataLoading::test_load_invalid_file PASSED [ 34%]
tests/test_data_preparation.py::TestDataCleaning::test_remove_serial_column PASSED [ 36%]
tests/test_data_preparation.py::TestDataCleaning::test_duplicate_removal PASSED [ 39%]
tests/test_data_preparation.py::TestDataCleaning::test_missing_values_handling PASSED [ 41%]
tests/test_data_preparation.py::TestDataCleaning::test_data_types_preserved PASSED [ 43%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_feature_target_separation PASSED [ 46%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_missing_target_column PASSED [ 48%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_feature_names PASSED [ 51%]
tests/test_data_preparation.py::TestDataSplitting::test_split_proportions PASSED [ 53%]
tests/test_data_preparation.py::TestDataSplitting::test_split_reproducibility PASSED [ 56%]
tests/test_data_preparation.py::TestDataSplitting::test_no_data_leakage PASSED [ 58%]
tests/test_data_preparation.py::TestDataIntegrity::test_processed_data_exists PASSED [ 60%]
tests/test_data_preparation.py::TestDataIntegrity::test_data_consistency PASSED [ 63%]
tests/test_model_training.py::TestDataLoading::test_load_processed_data_success PASSED [ 65%]
tests/test_model_training.py::TestDataLoading::test_load_processed_data_missing_files PASSED [ 68%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_shapes PASSED [ 70%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_normalization PASSED [ 73%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_consistency PASSED [ 75%]
tests/test_model_training.py::TestModelCreation::test_create_models_returns_dict PASSED [ 78%]
tests/test_model_training.py::TestModelCreation::test_create_models_types PASSED [ 80%]
tests/test_model_training.py::TestModelCreation::test_models_have_random_state PASSED [ 82%]
tests/test_model_training.py::TestModelEvaluation::test_evaluate_models_cv_returns_results PASSED [ 85%]
tests/test_model_training.py::TestModelEvaluation::test_best_model_selection PASSED [ 87%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_structure PASSED [ 90%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_perfect_prediction PASSED [ 92%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_bounds PASSED [ 95%]
tests/test_model_training.py::TestModelTraining::test_train_best_model PASSED [ 97%]
tests/test_model_training.py::TestIntegrationTests::test_full_pipeline_with_real_data PASSED [100%]

=================================== FAILURES ===================================
__________________ TestBentoMLIntegration.test_model_deletion __________________

self = <test_bentoml_integration.TestBentoMLIntegration object at 0x7f45c49e2dd0>

    def test_model_deletion(self):
        """Test model deletion from BentoML store."""
        from sklearn.linear_model import LinearRegression
    
        # Create a temporary model
        model = LinearRegression()
        X = pd.DataFrame(SAMPLE_DATA)
        y = np.array([0.7, 0.9, 0.4])
        model.fit(X, y)
    
        saved_model = bentoml.sklearn.save_model(
            f"{BENTOML_MODEL_NAME}_deletion_test",
            model,
            metadata={"temporary": True}
        )
    
        # Verify model exists
        assert bentoml.models.get(saved_model.tag) is not None
    
        # Delete model
        bentoml.models.delete(saved_model.tag)
    
        # Verify model is deleted
        with pytest.raises(bentoml.exceptions.NotFound):
            bentoml.models.get(saved_model.tag)
        with pytest.raises(bentoml.exceptions.NotFound):
>           bentoml.models.get(model_tag)
E           NameError: name 'model_tag' is not defined

tests/test_bentoml_integration.py:189: NameError
=============================== warnings summary ===============================
tests/test_model_training.py:259
  /home/ubuntu/examen_bentoml/tests/test_model_training.py:259: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/__init__.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/__init__.py:4: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/opener/__init__.py:6: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs.opener')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/pkg_resources/__init__.py:2558: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_prediction_service
tests/test_bentoml_integration.py::TestErrorHandling::test_prediction_with_wrong_input_shape
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names
    warnings.warn(

tests/test_data_preparation.py::TestDataCleaning::test_missing_values_handling
  /home/ubuntu/examen_bentoml/src/prepare_data.py:70: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
  The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
  
  For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
  
  
    df[col].fillna(df[col].median(), inplace=True)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.18-final-0 _______________

Name                  Stmts   Miss  Cover   Missing
---------------------------------------------------
src/__init__.py           6      6     0%   8-15
src/prepare_data.py     117     44    62%   43-45, 131-158, 162-201
src/train_model.py      142     64    55%   44, 161-187, 191-223, 227-243, 247-297
---------------------------------------------------
TOTAL                   265    114    57%
Coverage HTML written to dir htmlcov
Required test coverage of 30% reached. Total coverage: 56.98%
=========================== short test summary info ============================
FAILED tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_deletion - NameError: name 'model_tag' is not defined
=================== 1 failed, 40 passed, 8 warnings in 8.37s ===================

2025-06-26 09:31:39,357 - INFO - 
================================================================================
2025-06-26 09:31:39,357 - INFO - Running: Full Test Suite with Coverage
2025-06-26 09:31:39,357 - INFO - Command: python -m pytest tests/ -v --cov=src --cov-report=term-missing
2025-06-26 09:31:39,357 - INFO - ================================================================================
2025-06-26 09:31:48,715 - ERROR - ‚ùå FAILED: Full Test Suite with Coverage
2025-06-26 09:31:48,716 - ERROR - Standard output:
============================= test session starts ==============================
platform linux -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /home/ubuntu/examen_bentoml/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/ubuntu/examen_bentoml
configfile: pyproject.toml
plugins: anyio-4.9.0, cov-6.2.1
collecting ... collected 41 items

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load PASSED [  2%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_metadata PASSED [  4%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_custom_objects PASSED [  7%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_prediction_service PASSED [  9%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_store_listing PASSED [ 12%]
tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_deletion FAILED [ 14%]
tests/test_bentoml_integration.py::TestModelPerformanceValidation::test_saved_model_performance_threshold PASSED [ 17%]
tests/test_bentoml_integration.py::TestModelPerformanceValidation::test_model_feature_consistency PASSED [ 19%]
tests/test_bentoml_integration.py::TestErrorHandling::test_load_nonexistent_model PASSED [ 21%]
tests/test_bentoml_integration.py::TestErrorHandling::test_save_invalid_model PASSED [ 24%]
tests/test_bentoml_integration.py::TestErrorHandling::test_prediction_with_wrong_input_shape PASSED [ 26%]
tests/test_data_preparation.py::TestDataLoading::test_load_existing_file PASSED [ 29%]
tests/test_data_preparation.py::TestDataLoading::test_load_nonexistent_file PASSED [ 31%]
tests/test_data_preparation.py::TestDataLoading::test_load_invalid_file PASSED [ 34%]
tests/test_data_preparation.py::TestDataCleaning::test_remove_serial_column PASSED [ 36%]
tests/test_data_preparation.py::TestDataCleaning::test_duplicate_removal PASSED [ 39%]
tests/test_data_preparation.py::TestDataCleaning::test_missing_values_handling PASSED [ 41%]
tests/test_data_preparation.py::TestDataCleaning::test_data_types_preserved PASSED [ 43%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_feature_target_separation PASSED [ 46%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_missing_target_column PASSED [ 48%]
tests/test_data_preparation.py::TestFeatureTargetPreparation::test_feature_names PASSED [ 51%]
tests/test_data_preparation.py::TestDataSplitting::test_split_proportions PASSED [ 53%]
tests/test_data_preparation.py::TestDataSplitting::test_split_reproducibility PASSED [ 56%]
tests/test_data_preparation.py::TestDataSplitting::test_no_data_leakage PASSED [ 58%]
tests/test_data_preparation.py::TestDataIntegrity::test_processed_data_exists PASSED [ 60%]
tests/test_data_preparation.py::TestDataIntegrity::test_data_consistency PASSED [ 63%]
tests/test_model_training.py::TestDataLoading::test_load_processed_data_success PASSED [ 65%]
tests/test_model_training.py::TestDataLoading::test_load_processed_data_missing_files PASSED [ 68%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_shapes PASSED [ 70%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_normalization PASSED [ 73%]
tests/test_model_training.py::TestFeaturePreprocessing::test_preprocessing_consistency PASSED [ 75%]
tests/test_model_training.py::TestModelCreation::test_create_models_returns_dict PASSED [ 78%]
tests/test_model_training.py::TestModelCreation::test_create_models_types PASSED [ 80%]
tests/test_model_training.py::TestModelCreation::test_models_have_random_state PASSED [ 82%]
tests/test_model_training.py::TestModelEvaluation::test_evaluate_models_cv_returns_results PASSED [ 85%]
tests/test_model_training.py::TestModelEvaluation::test_best_model_selection PASSED [ 87%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_structure PASSED [ 90%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_perfect_prediction PASSED [ 92%]
tests/test_model_training.py::TestMetricsCalculation::test_calculate_metrics_bounds PASSED [ 95%]
tests/test_model_training.py::TestModelTraining::test_train_best_model PASSED [ 97%]
tests/test_model_training.py::TestIntegrationTests::test_full_pipeline_with_real_data PASSED [100%]

=================================== FAILURES ===================================
__________________ TestBentoMLIntegration.test_model_deletion __________________

self = <test_bentoml_integration.TestBentoMLIntegration object at 0x7f69bd4e6e60>

    def test_model_deletion(self):
        """Test model deletion from BentoML store."""
        from sklearn.linear_model import LinearRegression
    
        # Create a temporary model
        model = LinearRegression()
        X = pd.DataFrame(SAMPLE_DATA)
        y = np.array([0.7, 0.9, 0.4])
        model.fit(X, y)
    
        saved_model = bentoml.sklearn.save_model(
            f"{BENTOML_MODEL_NAME}_deletion_test",
            model,
            metadata={"temporary": True}
        )
    
        # Verify model exists
        assert bentoml.models.get(saved_model.tag) is not None
    
        # Delete model
        bentoml.models.delete(saved_model.tag)
    
        # Verify model is deleted
        with pytest.raises(bentoml.exceptions.NotFound):
            bentoml.models.get(saved_model.tag)
        with pytest.raises(bentoml.exceptions.NotFound):
>           bentoml.models.get(model_tag)
E           NameError: name 'model_tag' is not defined

tests/test_bentoml_integration.py:189: NameError
=============================== warnings summary ===============================
tests/test_model_training.py:259
  /home/ubuntu/examen_bentoml/tests/test_model_training.py:259: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/__init__.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/__init__.py:4: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/fs/opener/__init__.py:6: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs.opener')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_bentoml_model_save_load
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/pkg_resources/__init__.py:2558: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_prediction_service
tests/test_bentoml_integration.py::TestErrorHandling::test_prediction_with_wrong_input_shape
  /home/ubuntu/examen_bentoml/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names
    warnings.warn(

tests/test_data_preparation.py::TestDataCleaning::test_missing_values_handling
  /home/ubuntu/examen_bentoml/src/prepare_data.py:70: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
  The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
  
  For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
  
  
    df[col].fillna(df[col].median(), inplace=True)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.18-final-0 _______________

Name                  Stmts   Miss  Cover   Missing
---------------------------------------------------
src/__init__.py           6      6     0%   8-15
src/prepare_data.py     117     44    62%   43-45, 131-158, 162-201
src/train_model.py      142     64    55%   44, 161-187, 191-223, 227-243, 247-297
---------------------------------------------------
TOTAL                   265    114    57%
Coverage HTML written to dir htmlcov
Required test coverage of 30% reached. Total coverage: 56.98%
=========================== short test summary info ============================
FAILED tests/test_bentoml_integration.py::TestBentoMLIntegration::test_model_deletion - NameError: name 'model_tag' is not defined
=================== 1 failed, 40 passed, 8 warnings in 8.09s ===================

2025-06-26 09:31:48,716 - INFO - 
================================================================================
2025-06-26 09:31:48,716 - INFO - üìã FINAL TEST SUMMARY
2025-06-26 09:31:48,717 - INFO - ================================================================================
2025-06-26 09:31:48,717 - INFO - Total Tests: 6
2025-06-26 09:31:48,717 - INFO - ‚úÖ Passed: 1
2025-06-26 09:31:48,717 - INFO - ‚ùå Failed: 5
2025-06-26 09:31:48,717 - INFO - Success Rate: 16.7%
2025-06-26 09:31:48,717 - WARNING - ‚ö†Ô∏è  5 test(s) failed
